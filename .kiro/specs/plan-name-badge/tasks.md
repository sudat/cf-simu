# Implementation Plan

- [x] 1. ShadcnのBadgeコンポーネントのインストール
  - ShadcnのBadgeコンポーネントをプロジェクトにインストール
  - 既存のUIコンポーネントとの整合性を確認
  - _Requirements: 4.1, 4.3_

- [x] 1.1 Badgeコンポーネントのインストール
  - `bunx shadcn@latest add badge`コマンドを実行してBadgeコンポーネントをインストール
  - components/ui/badge.tsxファイルが正しく作成されることを確認
  - 既存のTailwind CSSクラスとの競合がないことを確認
  - _Requirements: 4.1, 4.3_

- [x] 2. PlanNameBadgeコンポーネントの作成
  - プラン名を表示するためのラッパーコンポーネントを作成
  - デフォルトプランの場合は非表示にするロジックを実装
  - _Requirements: 1.1, 1.2, 1.3, 2.1, 2.3, 3.1, 3.2, 3.3_

- [x] 2.1 PlanNameBadgeコンポーネントの実装
  - components/dialogs/amount-dialog/components/PlanNameBadge.tsxファイルを作成
  - ShadcnのBadgeコンポーネントを使用してプラン名バッジを実装
  - デフォルトプラン判定ロジックを実装（"デフォルトプラン"の場合は非表示）
  - 青系統の色（bg-blue-100, text-blue-800）でスタイリング
  - プラン名が長い場合の省略表示（CSS ellipsis）を実装
  - _Requirements: 1.2, 1.3, 2.1, 2.3, 3.1, 3.2, 3.3_

- [x] 3. AmountDialogコンポーネントの拡張
  - 既存のAmountDialogにプラン名バッジとプラン選択ボタンを追加
  - プラン情報の取得ロジックを実装
  - _Requirements: 1.1, 2.2, 4.1, 4.2, 4.3_

- [x] 3.1 プラン情報取得ロジックの実装
  - usePlanStoreからアクティブプラン情報を取得する関数を実装
  - エラーハンドリング（プラン情報取得失敗時はデフォルトプランとして扱う）
  - プラン名からitemNameを抽出するロジックを実装
  - _Requirements: 4.1, 4.2_

- [x] 3.2 プラン選択ボタンの追加
  - DialogHeaderまたはDialogFooterにプラン選択ボタンを追加
  - 青系統の色でプラン名バッジとの視覚的関連性を表現
  - onPlanSelectコールバックプロパティを追加
  - _Requirements: 2.2, 4.1, 4.2_

- [x] 3.3 プラン名バッジの表示実装
  - DialogDescriptionの近くにプラン名バッジを配置
  - アクティブプラン情報に基づいてバッジの表示/非表示を制御
  - デフォルトプランの場合はバッジを表示しない
  - _Requirements: 1.1, 1.2, 1.3, 2.1, 2.3_

- [x] 4. AmountDialogPropsインターフェースの拡張
  - 新しいプロパティを追加して後方互換性を保持
  - TypeScript型定義を更新
  - _Requirements: 4.1, 4.3_

- [x] 4.1 AmountDialogPropsの拡張
  - onPlanSelect?: () => voidプロパティを追加
  - 既存のプロパティには影響しない設計
  - デフォルト値を設定して後方互換性を確保
  - _Requirements: 4.1, 4.3_

- [x] 5. 単体テストの作成
  - PlanNameBadgeコンポーネントのテストを作成
  - AmountDialogの拡張機能のテストを作成
  - _Requirements: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 3.1, 3.2, 3.3_

- [x] 5.1 PlanNameBadgeコンポーネントのテスト
  - __tests__/components/PlanNameBadge.test.tsxファイルを作成
  - デフォルトプランの場合に非表示になることをテスト
  - 非デフォルトプランの場合に正しく表示されることをテスト
  - 正しいスタイルクラスが適用されることをテスト
  - 長いプラン名の省略表示をテスト
  - _Requirements: 1.2, 1.3, 2.1, 2.3, 3.1, 3.2, 3.3_

- [x] 5.2 AmountDialog拡張機能のテスト
  - __tests__/components/AmountDialog.test.tsxファイルを更新
  - プラン名バッジが正しい位置に表示されることをテスト
  - プラン選択ボタンが正しく動作することをテスト
  - デフォルトプランの場合にバッジが表示されないことをテスト
  - プラン情報取得エラー時の動作をテスト
  - _Requirements: 1.1, 2.2, 4.1, 4.2_

- [x] 6. 統合テストの実行
  - プラン切り替え時の動作確認
  - UI/UXの視覚的確認
  - _Requirements: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3_

- [x] 6.1 プラン切り替えテスト
  - プラン選択後にバッジの表示が更新されることを確認
  - デフォルトプランに戻した場合にバッジが非表示になることを確認
  - プラン選択ボタンとバッジの連携動作を確認
  - _Requirements: 1.1, 1.2, 1.3_

- [x] 6.2 UI/UXテスト
  - バッジとプラン選択ボタンの視覚的関連性を確認
  - 色の統一性（青系統）を確認
  - アクセシビリティ（コントラスト比）を確認
  - レスポンシブ対応を確認
  - _Requirements: 2.1, 2.2, 2.3, 3.1, 3.2, 3.3_

- [x] 7. 最終検証とドキュメント更新
  - 全体的な動作確認
  - 既存機能への影響がないことを確認
  - _Requirements: 4.1, 4.2, 4.3_

- [x] 7.1 回帰テスト
  - 既存のAmountDialog機能が正常に動作することを確認
  - 他のダイアログコンポーネントへの影響がないことを確認
  - パフォーマンスに悪影響がないことを確認
  - _Requirements: 4.1, 4.2, 4.3_

- [ ] 7.2 コードレビューと最適化
  - TypeScript型定義の最適化
  - 不要なコードの削除
  - コメントの追加と整理
  - _Requirements: 4.1, 4.3_