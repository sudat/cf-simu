# Requirements Document

## Introduction

現在のプラン管理システムでは、プランがグローバルに管理されており、一つの項目でプランを作成すると他の項目でも同じプランが表示される問題があります。この機能では、プランを項目別に完全に独立管理し、各項目が独自のプランセットを持つように改善します。

## Requirements

### Requirement 1

**User Story:** ユーザーとして、各収支項目が独立したプランセットを持つことで、一つの項目でプランを作成しても他の項目に影響しないようにしたい。

#### Acceptance Criteria

1. WHEN 「給与」項目に新しいプランを作成する THEN そのプランは「給与」項目でのみ利用可能になる SHALL
2. WHEN 「生活費」項目のプラン管理を表示する THEN 他の項目で作成されたプランは表示されない SHALL
3. WHEN 一つの項目からプランを削除する THEN 他の項目の同名プランには影響しない SHALL
4. WHEN 異なる項目で同じ名前のプランを作成する THEN それらは独立した別々のプランとして扱われる SHALL

### Requirement 2

**User Story:** ユーザーとして、特定の項目のプラン管理時に関連するプランのみを表示することで、他の項目のプランによる混乱を避けたい。

#### Acceptance Criteria

1. WHEN 項目のプラン管理を開く THEN その項目に属するプランのみが表示される SHALL
2. WHEN 項目に新しいプランを追加する THEN その項目の利用可能プランにのみ追加される SHALL （**実装完了**）
3. WHEN 項目のアクティブプランを選択する THEN その特定の項目にのみ影響する SHALL
4. WHEN 項目からプランを削除する THEN その項目の利用可能プランからのみ削除される SHALL

### Requirement 3

**User Story:** ユーザーとして、デフォルトプランがすべての項目で利用可能であることで、各項目が最低一つのプラン選択肢を持つようにしたい。

#### Acceptance Criteria

1. WHEN 新しい項目が作成される THEN 自動的に「デフォルトプラン」が利用可能になる SHALL
2. WHEN 「デフォルトプラン」を削除しようとする THEN システムが削除を防止する SHALL
3. WHEN 任意の項目のプラン管理を表示する THEN 「デフォルトプラン」が常に表示される SHALL
4. WHEN 項目にカスタムプランを作成する THEN 「デフォルトプラン」も引き続き利用可能である SHALL

### Requirement 4

**User Story:** ユーザーとして、システムが後方互換性を維持することで、既存のデータと機能が正しく動作し続けるようにしたい。

#### Acceptance Criteria

1. WHEN システムが更新される THEN 既存のプラン割り当てが保持される SHALL
2. WHEN 既存の項目にアクセスする THEN 現在のアクティブプランが変更されない SHALL
3. WHEN 既存の機能を使用する THEN 以前と同じように動作する SHALL
4. WHEN 旧システムから移行する THEN データが失われない SHALL
